# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ£€æŸ¥æ¸…å•

## âœ… å·²å®Œæˆçš„é…ç½®

### 1. å‰ç«¯é…ç½®
- [x] ä¿®æ”¹äº† `frontend/src/config/api.ts` ä¸­çš„ç”Ÿäº§ç¯å¢ƒåŸŸå
- [x] ä¼˜åŒ–äº† `resolveMediaUrl` å‡½æ•°
- [x] é‡æ–°æ„å»ºäº†å‰ç«¯ (`npm run build`)
- [x] éªŒè¯æ„å»ºæ–‡ä»¶ä¸­åŒ…å«æ­£ç¡®çš„åŸŸåé…ç½®

### 2. åç«¯é…ç½®
- [x] Djangoåª’ä½“æ–‡ä»¶é…ç½®æ­£ç¡® (`MEDIA_URL = '/media/'`)
- [x] å­åˆ†ç±»åŠŸèƒ½å·²å®ç°
- [x] APIæ¥å£æ”¯æŒå­åˆ†ç±»

## ğŸ” éœ€è¦éªŒè¯çš„é…ç½®

### 1. Nginxé…ç½®æ£€æŸ¥
è¯·ç¡®è®¤æ‚¨çš„Nginxé…ç½®åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

```nginx
# å‰ç«¯é™æ€æ–‡ä»¶
location / {
    root /www/wwwroot/Aluminum/frontend/build;
    try_files $uri $uri/ /index.html;
}

# åç«¯API
location /api/ {
    proxy_pass http://127.0.0.1:8000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

# åª’ä½“æ–‡ä»¶
location /media/ {
    alias /www/wwwroot/Aluminum/backend/media/;
    expires 30d;
    add_header Cache-Control "public, immutable";
}
```

### 2. æ–‡ä»¶æƒé™æ£€æŸ¥
```bash
# æ£€æŸ¥åª’ä½“æ–‡ä»¶ç›®å½•æƒé™
ls -la /www/wwwroot/Aluminum/backend/media/
ls -la /www/wwwroot/Aluminum/frontend/build/

# ç¡®ä¿Nginxå¯ä»¥è®¿é—®è¿™äº›æ–‡ä»¶
chown -R www:www /www/wwwroot/Aluminum/backend/media/
chown -R www:www /www/wwwroot/Aluminum/frontend/build/
```

### 3. æœåŠ¡çŠ¶æ€æ£€æŸ¥
```bash
# æ£€æŸ¥DjangoæœåŠ¡
systemctl status your-django-service

# æ£€æŸ¥NginxæœåŠ¡
systemctl status nginx

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :80
netstat -tlnp | grep :8000
```

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. è®¿é—®æµ‹è¯•é¡µé¢
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://lingyealu.cn/test-url.html`

### 2. æ£€æŸ¥å›¾ç‰‡URL
1. è®¿é—®äº§å“é¡µé¢ï¼š`http://lingyealu.cn/products`
2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
3. æŸ¥çœ‹Networkæ ‡ç­¾ä¸­çš„å›¾ç‰‡è¯·æ±‚
4. ç¡®è®¤å›¾ç‰‡URLæ˜¯å¦æ˜¾ç¤ºä¸º `http://lingyealu.cn/media/products/...`

### 3. æµ‹è¯•APIæ¥å£
```bash
# æµ‹è¯•åˆ†ç±»API
curl http://lingyealu.cn/api/categories/

# æµ‹è¯•äº§å“API
curl http://lingyealu.cn/api/products/

# æµ‹è¯•åª’ä½“æ–‡ä»¶
curl -I http://lingyealu.cn/media/products/your-image.jpg
```

## ğŸš¨ å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1: å›¾ç‰‡ä»ç„¶æ˜¾ç¤ºå¼€å‘ç¯å¢ƒåœ°å€
**è§£å†³æ–¹æ¡ˆ:**
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ (Ctrl+F5)
2. ç¡®è®¤å·²é‡æ–°æ„å»ºå‰ç«¯
3. æ£€æŸ¥Nginxé…ç½®æ˜¯å¦æ­£ç¡®

### é—®é¢˜2: å›¾ç‰‡æ— æ³•åŠ è½½
**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥æ–‡ä»¶æƒé™ï¼š`ls -la /www/wwwroot/Aluminum/backend/media/`
2. æ£€æŸ¥Nginxé…ç½®ä¸­çš„åª’ä½“æ–‡ä»¶è·¯å¾„
3. æ£€æŸ¥Djangoçš„MEDIA_ROOTè®¾ç½®

### é—®é¢˜3: APIè¯·æ±‚å¤±è´¥
**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥DjangoæœåŠ¡æ˜¯å¦è¿è¡Œ
2. æ£€æŸ¥Nginxä»£ç†é…ç½®
3. æŸ¥çœ‹Djangoæ—¥å¿—ï¼š`tail -f /path/to/django/logs/`

## ğŸ“‹ éƒ¨ç½²å‘½ä»¤

```bash
# 1. é‡æ–°æ„å»ºå‰ç«¯
cd /www/wwwroot/Aluminum/frontend
npm run build

# 2. é‡å¯DjangoæœåŠ¡
systemctl restart your-django-service

# 3. é‡å¯Nginx
systemctl restart nginx

# 4. æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status nginx
systemctl status your-django-service
```

## âœ… éªŒè¯æ¸…å•

- [ ] å‰ç«¯æ„å»ºæˆåŠŸ
- [ ] åŸŸåé…ç½®æ­£ç¡®
- [ ] Nginxé…ç½®æ­£ç¡®
- [ ] æ–‡ä»¶æƒé™æ­£ç¡®
- [ ] æœåŠ¡è¿è¡Œæ­£å¸¸
- [ ] å›¾ç‰‡URLæ˜¾ç¤ºæ­£ç¡®
- [ ] APIæ¥å£æ­£å¸¸
- [ ] å­åˆ†ç±»åŠŸèƒ½æ­£å¸¸

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
2. Nginxé”™è¯¯æ—¥å¿—
3. Djangoé”™è¯¯æ—¥å¿—
4. å…·ä½“çš„é”™è¯¯ç°è±¡æè¿°
